alias NimbleCSV.RFC4180, as: CSV

csv = """
mifune-productions,adventure-of-kigan-castle-1966
toho,adventure-of-kigan-castle-1966
daiei,adventures-of-zatoichi-1964
ntt-learning-systems,alive-2003
klock-worx,alive-2003
hammers,alive-2003
nikkatsu,alive-2003
suplex,alive-2003
skyworks,alive-2003
napalm-films,alive-2003
kss,alive-2003
eisei-gekijo,alive-2003
toho,all-monsters-attack-1969
napalm-films,aragami-2003
studio-3,aragami-2003
robot-communications,assassination-classroom-2015
j-storm,assassination-classroom-2015
shueisha,assassination-classroom-2015
fuji-television-network,assassination-classroom-2015
toho,assassination-classroom-2015
toho,assassination-classroom-graduation-2016
shueisha,assassination-classroom-graduation-2016
fuji-television-network,assassination-classroom-graduation-2016
robot-communications,assassination-classroom-graduation-2016
j-storm,assassination-classroom-graduation-2016
geneon-universal-entertainment,assault-girls-2009
deiz,assault-girls-2009
toho,atragon-1963
bandai-visual,avalon-2001
media-factory,avalon-2001
dentsu,avalon-2001
nippon-herald-films,avalon-2001
deiz,avalon-2001
toho,battle-in-outer-space-1959
sega,battle-royale-ii-requiem-2003
fukasaku-group,battle-royale-ii-requiem-2003
tv-asahi,battle-royale-ii-requiem-2003
wowow,battle-royale-ii-requiem-2003
gaga-communications,battle-royale-ii-requiem-2003
nippan-group-holdings,battle-royale-ii-requiem-2003
tokyo-fm,battle-royale-ii-requiem-2003
toei-video,battle-royale-ii-requiem-2003
toei-advertising,battle-royale-ii-requiem-2003
toei,battle-royale-ii-requiem-2003
toei,bullet-train-1975
studio-ghibli,castle-in-the-sky-1986
tokuma-shoten,castle-in-the-sky-1986
toho,conflagration-1975
toho,crossfire-2000
tokyo-broadcasting-system,crossfire-2000
tsuburaya,daigoro-vs-goliath-1972
toho,daigoro-vs-goliath-1972
daiei,daimajin-1966
toho,daredevil-in-the-castle-1961
toho,destroy-all-monsters-1968
toho,dogora-1964
toho,ebirah-horror-of-the-deep-1966
tsuburaya,eko-eko-azarak-ii-birth-of-the-wizard-1996
gaga-communications,eko-eko-azarak-ii-birth-of-the-wizard-1996
gaga-communications,eko-eko-azarak-iii-misa-the-dark-angel-1998
tsuburaya,eko-eko-azarak-iii-misa-the-dark-angel-1998
tsuburaya,eko-eko-azarak-wizard-of-darkness-1995
gaga-communications,eko-eko-azarak-wizard-of-darkness-1995
toho,espy-1974
toho,evil-of-dracula-1974
daiei,fight-zatoichi-fight-1964
toho,frankenstein-conquers-the-world-1965
nippon-television-network,gamera-2-attack-of-legion-1996
daiei,gamera-2-attack-of-legion-1996
hakuhodo,gamera-2-attack-of-legion-1996
nippan-group-holdings,gamera-2-attack-of-legion-1996
fujitsu,gamera-2-attack-of-legion-1996
tokuma-shoten,gamera-3-revenge-of-iris-1999
daiei,gamera-3-revenge-of-iris-1999
nippon-television-network,gamera-3-revenge-of-iris-1999
hakuhodo,gamera-3-revenge-of-iris-1999
nippan-group-holdings,gamera-3-revenge-of-iris-1999
hakuhodo,gamera-guardian-of-the-universe-1995
nippon-television-network,gamera-guardian-of-the-universe-1995
daiei,gamera-guardian-of-the-universe-1995
daiei,gamera-super-monster-1980
daiei,gamera-the-giant-monster-1965
daiei,gamera-vs-barugon-1966
daiei,gamera-vs-guiron-1969
daiei,gamera-vs-gyaos-1967
daiei,gamera-vs-jiger-1970
daiei,gamera-vs-viras-1968
shochiku,genocide-1968
toho,ghidorah-the-three-headed-monster-1964
production-ig,ghost-in-the-shell-1995
manga-entertainment,ghost-in-the-shell-1995
bandai-visual,ghost-in-the-shell-1995
kodansha,ghost-in-the-shell-1995
toho,g-i-samurai-1979
kadokawa,g-i-samurai-1979
mifune-productions,g-i-samurai-1979
toho,godzilla-1954
toho,godzilla-2000-millennium-1999
toho,godzilla-against-mechagodzilla-2002
toho,godzilla-final-wars-2004
toho,godzilla-mothra-and-king-ghidorah-giant-monsters-all-out-attack-2001
toho,godzilla-raids-again-1955
toho,godzilla-tokyo-sos-2003
toho,godzilla-vs-biollante-1989
toho,godzilla-vs-destoroyah-1995
toho,godzilla-vs-gigan-1972
toho,godzilla-vs-hedorah-1971
toho,godzilla-vs-king-ghidorah-1991
toho,godzilla-vs-mechagodzilla-1974
toho,godzilla-vs-mechagodzilla-ii-1993
toho,godzilla-vs-megaguirus-2000
toho,godzilla-vs-megalon-1973
toho,godzilla-vs-mothra-1992
toho,godzilla-vs-spacegodzilla-1994
shochiku,goke-body-snatcher-from-hell-1968
toei,golden-bat-1966
toho,gorath-1962
toho,gunhed-1989
imagica,gunhed-1989
kadokawa-shoten,gunhed-1989
bandai,gunhed-1989
sunrise,gunhed-1989
toho,hidden-fortress-1958
yomiuri-shimbun,hidden-fortress-the-last-princess-2008
chukyo-tv-broadcasting,hidden-fortress-the-last-princess-2008
nippon-television-network,hidden-fortress-the-last-princess-2008
shogakukan,hidden-fortress-the-last-princess-2008
j-storm,hidden-fortress-the-last-princess-2008
yomiuri-telecasting-corporation,hidden-fortress-the-last-princess-2008
dentsu,hidden-fortress-the-last-princess-2008
toho,hidden-fortress-the-last-princess-2008
kurosawa-productions,high-and-low-1963
toho,high-and-low-1963
toho,h-man-1958
toho,human-vapor-1960
toho,invasion-of-astro-monster-1965
toho,invisible-man-1954
bandai-visual,jin-roh-the-wolf-brigade-2000
production-ig,jin-roh-the-wolf-brigade-2000
toho,kagemusha-1980
20th-century-fox,kagemusha-1980
kurosawa-productions,kagemusha-1980
toei-advertising,kamen-rider-the-first-2005
toei-video,kamen-rider-the-first-2005
toei,kamen-rider-the-first-2005
toei-channel,kamen-rider-the-first-2005
toei-video,kamen-rider-the-next-2007
toei-channel,kamen-rider-the-next-2007
toei-advertising,kamen-rider-the-next-2007
toei,kamen-rider-the-next-2007
toho,king-kong-escapes-1967
toho,king-kong-vs-godzilla-1962
toho,lake-of-dracula-1971
toho,last-war-1961
toho,latitude-zero-1969
toei,legend-of-the-eight-samurai-1983
shochiku,living-skeleton-1968
kansai-television,lorelei-the-witch-of-the-pacific-ocean-2005
fuji-television-network,lorelei-the-witch-of-the-pacific-ocean-2005
toho,lorelei-the-witch-of-the-pacific-ocean-2005
king-records,lorelei-the-witch-of-the-pacific-ocean-2005
toho,lost-world-of-sinbad-1963
tokyo-movie-shinsha,lupin-iii-the-castle-of-cagliostro-1979
toei,magic-serpent-1966
toho,magnitude-7-9-1980
toho,matango-1963
toei,mechanical-violator-hakaider-1995
ishinomori-productions,mechanical-violator-hakaider-1995
toei-video,mechanical-violator-hakaider-1995
toei,message-from-space-1978
bandai-visual,moon-over-tao-1997
toho,mothra-1961
toho,mothra-vs-godzilla-1964
tokuma-shoten,my-neighbor-totoro-1988
studio-ghibli,my-neighbor-totoro-1988
toho,mysterians-1957
tokuma-shoten,nausicaa-of-the-valley-of-the-wind-1984
hakuhodo,nausicaa-of-the-valley-of-the-wind-1984
topcraft,nausicaa-of-the-valley-of-the-wind-1984
daiei,new-tale-of-zatoichi-1963
dentsu,oblivion-island-haruka-and-the-magic-mirror-2009
fuji-television-network,oblivion-island-haruka-and-the-magic-mirror-2009
production-ig,oblivion-island-haruka-and-the-magic-mirror-2009
pony-canyon,oblivion-island-haruka-and-the-magic-mirror-2009
toho,orochi-the-eight-headed-dragon-1994
fuji-television-network,parasite-eve-1997
kadokawa-shoten,parasite-eve-1997
bandai-visual,patlabor-2-the-movie-1993
tohokushinsha,patlabor-2-the-movie-1993
production-ig,patlabor-2-the-movie-1993
tohokushinsha,patlabor-the-movie-1989
bandai-visual,patlabor-the-movie-1989
toho,prophecies-of-nostradamus-1974
daiei,rashomon-1950
toho,rebirth-of-mothra-1996
toho,rebirth-of-mothra-ii-1997
toho,rebirth-of-mothra-iii-1998
omnibus-promotion,red-spectacles-1987
daiei,return-of-daimajin-1966
toho,return-of-godzilla-1984
toho,rodan-1956
warner-bros,sakuya-slayer-of-demons-2000
towani,sakuya-slayer-of-demons-2000
daiei,samaritan-zatoichi-1968
toho,samurai-ii-duel-at-ichijoji-temple-1955
toho,samurai-iii-duel-at-ganryu-island-1956
toho,samurai-i-musashi-miyamoto-1954
toei,samurai-reincarnation-1981
toho,sanjuro-1962
kurosawa-productions,sanjuro-1962
toho,sayonara-jupiter-1984
io,sayonara-jupiter-1984
toho,secret-of-the-telegian-1960
toho,seven-samurai-1954
toho,shin-godzilla-2016
toho,son-of-godzilla-1967
toho,space-amoeba-1970
omnibus-promotion,stray-dog-kerberos-panzer-cops-1991
fuji-television-network,stray-dog-kerberos-panzer-cops-1991
bandai,stray-dog-kerberos-panzer-cops-1991
toho,submersion-of-japan-1973
daiei,tale-of-zatoichi-1962
daiei,tale-of-zatoichi-continues-1962
embodiment-films,talking-head-1992
plex,talking-head-1992
bandai,talking-head-1992
toho,terror-of-mechagodzilla-1975
samurai-productions,three-outlaw-samurai-1964
shochiku,three-outlaw-samurai-1964
toho,three-treasures-1959
toho,throne-of-blood-1957
kansai-television,tokyo-blackout-1987
tokuma-shoten,tokyo-blackout-1987
daiei,tokyo-blackout-1987
toho,vampire-doll-1970
toho,varan-the-unbelievable-1958
napalm-films,versus-2000
kss,versus-2000
wevco,versus-2000
suplex,versus-2000
toho,war-in-space-1977
daiei,warning-from-space-1956
toho,war-of-the-gargantuas-1966
toho,whirlwind-1964
takarazuka,whirlwind-1964
daiei,wrath-of-daimajin-1966
shochiku,x-from-outer-space-1967
toho,yojimbo-1961
kurosawa-productions,yojimbo-1961
miku,zatoichi-1989
katsu-productions,zatoichi-1989
daiei,zatoichi-and-the-chess-expert-1965
daiei,zatoichi-and-the-chest-of-gold-1964
daiei,zatoichi-and-the-doomed-man-1965
daiei,zatoichi-and-the-fugitives-1968
toho,zatoichi-at-large-1972
katsu-productions,zatoichi-at-large-1972
daiei,zatoichi-challenged-1967
katsu-productions,zatoichi-goes-to-the-fire-festival-1970
dainichi,zatoichi-goes-to-the-fire-festival-1970
daiei,zatoichi-goes-to-the-fire-festival-1970
toho,zatoichi-in-desperation-1972
katsu-productions,zatoichi-in-desperation-1972
katsu-productions,zatoichi-meets-the-one-armed-swordsman-1971
toho,zatoichi-meets-the-one-armed-swordsman-1971
daiei,zatoichi-meets-yojimbo-1970
katsu-productions,zatoichi-meets-yojimbo-1970
daiei,zatoichi-on-the-road-1963
daiei,zatoichis-cane-sword-1967
katsu-productions,zatoichis-conspiracy-1973
toho,zatoichis-conspiracy-1973
daiei,zatoichis-flashing-sword-1964
daiei,zatoichis-pilgrimage-1966
daiei,zatoichis-revenge-1965
daiei,zatoichis-vengeance-1966
daiei,zatoichi-the-fugitive-1963
daiei,zatoichi-the-outlaw-1967
katsu-productions,zatoichi-the-outlaw-1967
crowd,zeiram-1991
gaga-communications,zeiram-1991
crowd,zeiram-2-1994
embodiment-films,zeiram-2-1994
"""

csv
|> CSV.parse_string(skip_headers: false)
|> Enum.map(fn [studio_slug, film_slug] ->
  studio = Cineaste.Library.get_studio_by_slug!(studio_slug)
  film = Cineaste.Library.get_film_by_slug!(film_slug)

  %{
    studio_id: studio.id,
    film_id: film.id
  }
end)
|> Ash.bulk_create(Cineaste.Library.FilmStudio, :create, return_errors?: true)
